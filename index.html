<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesundheitskalender</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root{--primary:#4BA4F2;--secondary:#5CB9F2;--background:#DCEAF2;--accent:#04D94F;--text:#2C3E50;}
        *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
        body{background:var(--background);color:var(--text);padding:20px;}
        .view{display:none;max-width:800px;margin:0 auto;}
        .active-view{display:block;}
        .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;}
        .calendar-day{padding:10px;border:1px solid var(--primary);border-radius:5px;text-align:center;}
        .has-entries{background:var(--accent);color:white;}
        .section{background:white;border-radius:15px;padding:20px;margin:15px 0;box-shadow:0 2px 5px rgba(0,0,0,0.1);}
        input,select,textarea,button{width:100%;padding:10px;margin:5px 0;border:2px solid var(--secondary);border-radius:8px;}
        button{background:var(--accent);color:white;border:none;cursor:pointer;}
        .entry{position:relative;padding:10px;margin:10px 0;background:#f8f9fa;border-radius:8px;}
        .delete-btn{position:absolute;right:10px;top:50%;transform:translateY(-50%);color:red;cursor:pointer;}
        .slider-container{margin:15px 0;}
        .slider-labels{display:flex;justify-content:space-between;}
    </style>
</head>
<body>
    <div id="calendarView" class="active-view">
        <div class="section">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
                <button onclick="changeMonth(-1)">‚Üê</button>
                <h2 id="currentMonth"></h2>
                <button onclick="changeMonth(1)">‚Üí</button>
            </div>
            <div class="calendar-grid" id="calendar"></div>
        </div>
    </div>

    <div id="dayView" class="view">
        <div class="section">
            <button onclick="showView('calendarView')">‚Üê Zur√ºck</button>
            <h2 id="currentDay"></h2>
            
            <h3>üíä Medikation</h3>
            <input type="text" id="medName" placeholder="Medikament">
            <input type="text" id="dose" placeholder="Dosis">
            <input type="time" id="medTime">
            <select id="interval">
                <option value="4">4 Stunden</option>
                <option value="6">6 Stunden</option>
                <option value="8" selected>8 Stunden</option>
            </select>
            <button onclick="addMedication()">Hinzuf√ºgen</button>
            <div id="medicationList"></div>
            <div id="timer" class="section"></div>
        </div>

        <div class="section">
            <h3>üìä Vitalwerte</h3>
            <div class="slider-container">
                <label>Aktivit√§t: <span id="activityValue">Mittel</span></label>
                <input type="range" min="0" max="2" value="1" id="activity" oninput="updateSlider('activity')">
                <div class="slider-labels"><span>Niedrig</span><span>Mittel</span><span>Hoch</span></div>
            </div>
            <!-- Wiederholen f√ºr Appetit/Fl√ºssigkeit -->
            <button onclick="saveVitals()">Speichern</button>
            <div id="vitalsList"></div>
        </div>

        <div class="section">
            <h3>üå° Symptome</h3>
            <textarea id="symptomInput" rows="3"></textarea>
            <button onclick="addSymptom()">Hinzuf√ºgen</button>
            <div id="symptomsList"></div>
        </div>

        <button onclick="exportPDF()" style="margin-top:20px;">üìÑ PDF Export</button>
    </div>

<script>
let currentDate = new Date();
let healthData = JSON.parse(localStorage.getItem('healthData')) || {};

// Kalenderfunktionen
function renderCalendar(date) {
    const year = date.getFullYear();
    const month = date.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    
    document.getElementById('currentMonth').textContent = 
        `${date.toLocaleString('de-DE', {month:'long', year:'numeric'})}`;

    let calendarHTML = '';
    for(let day = 1; day <= lastDay.getDate(); day++) {
        const dayKey = `${year}-${String(month+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
        calendarHTML += `<div class="calendar-day ${healthData[dayKey] ? 'has-entries' : ''}" 
            onclick="showDay('${dayKey}')">${day}</div>`;
    }
    document.getElementById('calendar').innerHTML = calendarHTML;
}

// Datenverwaltung
function saveData(dayKey, type, entry) {
    if(!healthData[dayKey]) healthData[dayKey] = {meds:[], vitals:[], symptoms:[]};
    healthData[dayKey][type].push({...entry, id:Date.now()});
    localStorage.setItem('healthData', JSON.stringify(healthData));
}

// Timer-Logik
function updateTimer(nextDose) {
    const timer = setInterval(() => {
        const diff = nextDose - Date.now();
        if(diff < 0) {
            document.getElementById('timer').innerHTML = '‚è∞ Medikation f√§llig!';
            clearInterval(timer);
            return;
        }
        const hours = Math.floor(diff / 3600000);
        const minutes = Math.floor((diff % 3600000) / 60000);
        document.getElementById('timer').innerHTML = 
            `N√§chste Dosis in: ${hours}h ${minutes}m`;
    }, 1000);
}

// Initialisierung
document.addEventListener('DOMContentLoaded', () => {
    renderCalendar(currentDate);
    // Weitere Initialisierungen...
});
</script>
</body>
</html>